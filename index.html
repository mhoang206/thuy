<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>üíú G·ª≠i Em üíú</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&display=swap');

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html, body {
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #000;
    cursor: none;
  }

  canvas {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1;
  }

  .cursor-glow {
    position: fixed;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    pointer-events: none;
    z-index: 1000;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle, rgba(255,105,180,0.6) 0%, rgba(255,105,180,0) 70%);
    mix-blend-mode: screen;
    transition: width 0.3s, height 0.3s;
  }

  .start-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 100;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: radial-gradient(ellipse at center, rgba(10,0,20,0.95) 0%, rgba(0,0,0,0.99) 100%);
    transition: opacity 1.5s ease, visibility 1.5s ease;
  }

  .start-overlay.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
  }

  .start-overlay h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(1.5rem, 5vw, 3rem);
    color: transparent;
    background: linear-gradient(135deg, #ff69b4, #da70d6, #ffd700);
    -webkit-background-clip: text;
    background-clip: text;
    margin-bottom: 2rem;
    text-align: center;
    animation: shimmer 3s ease-in-out infinite;
  }

  .start-btn {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(1rem, 3vw, 1.4rem);
    padding: 15px 50px;
    border: 1px solid rgba(255,105,180,0.5);
    background: transparent;
    color: #ff69b4;
    border-radius: 50px;
    cursor: pointer;
    letter-spacing: 3px;
    text-transform: uppercase;
    transition: all 0.5s ease;
    position: relative;
    overflow: hidden;
  }

  .start-btn::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,105,180,0.2), transparent);
    transition: left 0.5s ease;
  }

  .start-btn:hover::before {
    left: 100%;
  }

  .start-btn:hover {
    background: rgba(255,105,180,0.1);
    border-color: #ff69b4;
    box-shadow: 0 0 30px rgba(255,105,180,0.3), inset 0 0 30px rgba(255,105,180,0.1);
    transform: scale(1.05);
  }

  .message-container {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 50;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    opacity: 0;
    transition: opacity 2s ease;
  }

  .message-container.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .message-scroll {
    max-width: 700px;
    max-height: 75vh;
    overflow-y: auto;
    padding: 40px 35px;
    margin: 20px;
    background: radial-gradient(ellipse at center, rgba(15,0,30,0.85) 0%, rgba(5,0,10,0.92) 100%);
    border: 1px solid rgba(255,105,180,0.15);
    border-radius: 20px;
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    box-shadow: 0 0 60px rgba(138,43,226,0.15), 0 0 120px rgba(255,105,180,0.08), inset 0 0 60px rgba(138,43,226,0.05);
    scrollbar-width: thin;
    scrollbar-color: rgba(255,105,180,0.3) transparent;
  }

  .message-scroll::-webkit-scrollbar {
    width: 4px;
  }

  .message-scroll::-webkit-scrollbar-track {
    background: transparent;
  }

  .message-scroll::-webkit-scrollbar-thumb {
    background: rgba(255,105,180,0.3);
    border-radius: 2px;
  }

  .message-line {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(0.95rem, 2.5vw, 1.15rem);
    line-height: 1.9;
    color: rgba(230,210,240,0.9);
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 1.2s ease, transform 1.2s ease;
    margin-bottom: 1.2em;
    text-align: justify;
    letter-spacing: 0.3px;
  }

  .message-line.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .message-line.highlight {
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: clamp(1.1rem, 3vw, 1.4rem);
    text-align: center;
    color: transparent;
    background: linear-gradient(135deg, #ff69b4, #ffd700, #da70d6);
    -webkit-background-clip: text;
    background-clip: text;
    font-weight: 700;
    margin: 1.5em 0;
    text-shadow: none;
  }

  .message-line.ending {
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: clamp(1rem, 2.8vw, 1.3rem);
    text-align: center;
    color: #ff69b4;
    margin-top: 1.5em;
    letter-spacing: 1px;
  }

  .close-msg-btn {
    display: block;
    margin: 30px auto 10px;
    font-family: 'Cormorant Garamond', serif;
    font-size: 1rem;
    padding: 10px 40px;
    border: 1px solid rgba(255,105,180,0.4);
    background: transparent;
    color: rgba(255,105,180,0.8);
    border-radius: 30px;
    cursor: pointer;
    letter-spacing: 2px;
    transition: all 0.4s ease;
    opacity: 0;
  }

  .close-msg-btn.visible {
    opacity: 1;
  }

  .close-msg-btn:hover {
    background: rgba(255,105,180,0.15);
    box-shadow: 0 0 20px rgba(255,105,180,0.2);
  }

  .read-btn {
    position: fixed;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 30;
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(0.9rem, 2.5vw, 1.1rem);
    padding: 12px 40px;
    border: 1px solid rgba(255,105,180,0.4);
    background: rgba(10,0,20,0.6);
    color: rgba(255,105,180,0.9);
    border-radius: 30px;
    cursor: pointer;
    letter-spacing: 2px;
    text-transform: uppercase;
    backdrop-filter: blur(10px);
    transition: all 0.5s ease;
    opacity: 0;
    visibility: hidden;
    animation: pulse-btn 2s ease-in-out infinite;
  }

  .read-btn.visible {
    opacity: 1;
    visibility: visible;
  }

  .read-btn:hover {
    background: rgba(255,105,180,0.15);
    border-color: #ff69b4;
    box-shadow: 0 0 30px rgba(255,105,180,0.25);
  }

  @keyframes shimmer {
    0%, 100% { filter: brightness(1); }
    50% { filter: brightness(1.3); }
  }

  @keyframes pulse-btn {
    0%, 100% { box-shadow: 0 0 10px rgba(255,105,180,0.1); }
    50% { box-shadow: 0 0 25px rgba(255,105,180,0.3); }
  }

  @keyframes float-star {
    0%, 100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.5); }
  }
</style>
</head>
<body>

<audio id="bgMusic" loop preload="auto">
  <source src="[LINK_NHAC_MP3_CUA_BAN_O_DAY]" type="audio/mpeg">
</audio>

<div class="cursor-glow" id="cursorGlow"></div>

<div class="start-overlay" id="startOverlay">
  <h1>‚ú® C√≥ ƒê√¥i ƒêi·ªÅu Mu·ªën N√≥i ‚ú®</h1>
  <button class="start-btn" id="startBtn">M·ªü Ra N√†o</button>
</div>

<canvas id="canvas"></canvas>

<button class="read-btn" id="readBtn">üíå ƒê·ªçc Th∆∞ Anh Vi·∫øt</button>

<div class="message-container" id="messageContainer">
  <div class="message-scroll" id="messageScroll">
    <p class="message-line">Em √†, qua 3 ng√†y t·∫øt r·ªìi m·ªçi th·ª© c≈©ng d·∫ßn l·∫Øng xu·ªëng, nh∆∞ng l·∫°i c√≥ ƒë√¥i ƒëi·ªÅu mu·ªën n√≥i v·ªõi em, mu·ªën b√†y t·ªè th·∫≠t l√≤ng v·ªõi em, n√™n anh v·∫´n ng·ªìi ƒë√¢y nghƒ© v·ªÅ em.</p>

    <p class="message-line">Tr∆∞·ªõc h·∫øt th√¨, ch√∫c em nƒÉm m·ªõi th·∫≠t nhi·ªÅu s·ª©c kho·∫ª, h·ªçc h√†nh thu·∫≠n l·ª£i, l√†m g√¨ c≈©ng su√¥n s·∫ª. Ch√∫c ebe b·ªõt ·∫©m ∆∞∆°ng, t·ª•t h·ª©ng t·∫•t th·ªùi l·∫°i m·ªôt ch√∫t ƒë·ªÉ anh ƒë·ª° kh·ªï, m√† th√¥i ƒë·ª´ng b·ªõt, anh quen r·ªìi, b·ªõt ƒëi anh l·∫°i nh·ªõ. V√† ch√∫c cho m√¨nh, qua nƒÉm m·ªõi n√†y, s·∫Ω kh√¥ng c√≤n ph·∫£i nh√¨n nhau qua c√°i m√†n h√¨nh n·ªØa.</p>

    <p class="message-line">M√† n√≥i thi·ªát, ng·ªìi nghƒ© l·∫°i t·ª´ c√°i chi·ªÅu 25/1 tr√™n Ome TV ƒë·∫øn gi·ªù, g·∫ßn 1 th√°ng r·ªìi, anh v·∫´n kh√¥ng tin n·ªïi. H√¥m ƒë√≥ anh l∆∞·ªõt qua bao nhi√™u ng∆∞·ªùi, ch·∫≥ng mu·ªën d·ª´ng l·∫°i v·ªõi ai. R·ªìi g·∫∑p em. N√≥i chuy·ªán m·ªôt l√∫c th√¥i m√† anh ƒë√£ th·∫•y con b√© n√†y n√≥ kh√°c. N√™n xin Facebook. L√∫c ƒë√≥ c≈©ng ch·∫≥ng nghƒ© g√¨ xa, ai ng·ªù gi·ªù n·∫±m ƒë√¢y nh·ªõ em mu·ªën ƒëi√™n.</p>

    <p class="message-line">G·∫ßn 1 th√°ng, c≈©ng kh√¥ng qu√° d√†i ƒë·ªÉ hi·ªÉu ƒë∆∞·ª£c 1 ng∆∞·ªùi nh∆∞ng anh kh√¥ng bi·∫øt sao l·∫°i c√≥ c·∫£m x√∫c nh∆∞ th√¢n th∆∞∆°ng quen nhau t·ª´ l√¢u l·∫Øm r·ªìi, n√≥i chuy·ªán v·ªõi nhau c≈©ng ch·∫£ th·∫•y c·∫°n nƒÉng l∆∞·ª£ng g√¨, r·∫•t th√≠ch n√≥i chuy·ªán v·ªõi em, n√™n l√† ch·ªâ c·∫ßn nh√™u ƒë√≥ th·ªùi gian th√¨ anh c≈©ng ƒë√£ hi·ªÉu t√≠nh c√°ch c·ªßa em, m·ªçi lu·ªìng suy nghƒ© c·ªßa em, hi·ªÉu em l√† ng∆∞·ªùi nh∆∞ th·∫ø n√†o. Em ch·∫£ kh√≥ t√≠nh nh∆∞ em n√≥i, em ch·ªâ b·ªã h·ªç tr√™u ƒë√πa, b·ªã t·ªïn th∆∞∆°ng qu√° nhi·ªÅu n√™n ph·∫£i c·∫©n th·∫≠n h∆°n. Anh hi·ªÉu, anh kh√¥ng tr√°ch, anh c≈©ng ch·∫£ m·ªát m·ªèi g√¨ khi ƒë∆∞·ª£c ti·∫øp c·∫≠n ƒë·∫øn em. Anh ch·ªâ mu·ªën em bi·∫øt l√† anh nh√¨n th·∫•y h·∫øt. Th·∫•y c√°i s·ª± m·∫°nh m·∫Ω ·ªü b√™n ngo√†i v√† th·∫•y c·∫£ ph·∫ßn m·ªÅm m·ªèng b√™n trong m√† em c·ªë gi·∫•u.</p>

    <p class="message-line highlight">Em s·ª£ b·ªã l·ª´a, anh bi·∫øt. Em t·ª´ng b·ªã ph·∫£n b·ªôi, anh bi·∫øt. Em hay t·ª± nh·ªß "kh√¥ng ai ch·ªãu ƒë∆∞·ª£c t√≠nh m√¨nh", anh c≈©ng bi·∫øt.</p>

    <p class="message-line">Nh∆∞ng m√† em √†, c√°i "bi·∫øt" c·ªßa anh n√≥ kh√°c m·∫•y th·∫±ng tr∆∞·ªõc. H·ªç bi·∫øt r·ªìi h·ªç ƒëi. C√≤n anh bi·∫øt r·ªìi anh ·ªü l·∫°i. V√¨ anh th·∫•y ƒë·∫±ng sau c√°i t√≠nh ƒë√≥ l√† m·ªôt ng∆∞·ªùi con g√°i r·∫•t x·ª©ng ƒë√°ng ƒë∆∞·ª£c y√™u th∆∞∆°ng ƒë√†ng ho√†ng.</p>

    <p class="message-line">Qua 1 √≠t th·ªùi gian ·∫•y, g·∫ßn 1 th√°ng, anh thay ƒë·ªïi nhi·ªÅu l·∫Øm. T·ª´ m·ªôt th·∫±ng hay b·∫Øt b√†i ng∆∞·ªùi kh√°c, gi·ªù th√†nh th·∫±ng n·∫±m c∆∞·ªùi m·ªôt m√¨nh v√¨ nh·ªõ em. T·ª´ th·∫±ng ch·∫≥ng bao gi·ªù ch·ªãu thua ai, gi·ªù t·ª± nguy·ªán l√†m ch√≥ cho em sai. Nghe n√≥ ngu, nh∆∞ng m√† thi·ªát. V√¨ v·ªõi em anh kh√¥ng c·∫ßn g·ªìng. Anh c·ª© l√† anh, d√π n√≥ c√≥ h∆°i h√¢m, h∆°i bi·∫øn th√°i, h∆°i l·ª≥.</p>

    <p class="message-line">V√† nh·ªØng c√°i h√†nh ƒë·ªông nh·ªè nhoi c·ªßa anh, anh c≈©ng kh√¥ng bi·∫øt l√† m√¨nh l√†m ƒë√∫ng ch∆∞a, t·∫°i anh c≈©ng kh√¥ng qu√° r√†nh v·ªÅ m·ªçi th·ª© v√† c·∫£ c·∫£m x√∫c c·ªßa 1 ng∆∞·ªùi kh√°c, nh∆∞ng d√π xa anh v·∫´n s·∫Ω t√¨m c√°ch ƒë·ªÉ g·∫ßn em, em g·ª≠i anh th·ª© g√¨ hay n√≥i th·ª© g√¨ anh ƒë·ªÅu xem ƒë·ªÅu ƒë·ªçc l·∫°i ƒë·ªÅu ƒë·∫∑n, v√≠ d·ª• nh∆∞ video em g·ª≠i anh bi·∫øt em ng·∫°i nh∆∞ng em v·∫´n g·ª≠i cho anh th√¨ anh qu√Ω c√°i s·ª± ch√¢n th√†nh n√†y l·∫Øm.</p>

    <p class="message-line">Em hay h·ªèi "sau n√†y ch√°n th√¨ sao". Anh kh√¥ng gi·ªèi h·ª©a h·∫πn. M·∫•y th·∫±ng tr∆∞·ªõc c≈©ng h·ª©a r·ªìi ch·∫°y. Anh ch·ªâ bi·∫øt l√†m. G·∫ßn 1 th√°ng nay nh·∫Øn m·ªói ng√†y kh√¥ng s√≥t. Ch·ªãu m·∫•y tr·∫≠n em x√π l√¥ng m√† kh√¥ng c√°u. T√≠nh k·∫ø ho·∫°ch th√°ng 3 ra HN. ƒê√≥ l√† c√°ch anh tr·∫£ l·ªùi. Kh√¥ng b·∫±ng m·ªìm, b·∫±ng vi·ªác anh l√†m. D√π c√≥ g·∫∑p ƒë∆∞·ª£c em √≠t ƒëi chƒÉng n·ªØa th√¨ khi n√†o anh s·∫Øp x·∫øp ƒë∆∞·ª£c th·ªùi gian l√† anh s·∫Ω g·∫∑p em li·ªÅn.</p>

    <p class="message-line">NƒÉm m·ªõi r·ªìi, anh ch·ªâ ∆∞·ªõc m·ªôt th·ª© th√¥i: Th√°ng 3 g·∫∑p em. ƒêi t√†u 24 ti·∫øng t·ª´ Ph√∫ Y√™n ra. Thi xong d√†nh h·∫øt cho em. ƒêi ch·ª£, n·∫•u c∆°m, d·∫Øt ƒëi xem phim, ch·ªü ƒëi l∆∞·ª£n. B√¨nh th∆∞·ªùng v·∫≠y th√¥i. R·ªìi l√∫c ƒë√≥ anh s·∫Ω nh√¨n m·∫∑t em m√† n√≥i h·∫øt m·∫•y th·ª© qua tin nh·∫Øn ch∆∞a n√≥i ƒë∆∞·ª£c.</p>

    <p class="message-line highlight">Anh kh√¥ng t·ªè t√¨nh qua ƒë√¢y. V√¨ anh mu·ªën l√∫c anh n√≥i c√¢u ƒë√≥, em ph·∫£i th·∫•y m·∫Øt anh. ƒê·ªÉ em bi·∫øt anh n√≥i thi·ªát.</p>

    <p class="message-line">N√™n l√† em √†, nƒÉm m·ªõi r·ªìi, b·ªè m·∫•y c√°i suy nghƒ© "kh√¥ng ai ch·ªãu ƒë∆∞·ª£c" ƒëi. C√≥ anh ƒë√¢y. Anh ch·ªãu ƒë∆∞·ª£c. Em c·ª© kh√≥, anh ·ªü l·∫°i. Em c·ª© d·ªü h∆°i, anh c∆∞·ªùi r·ªìi th∆∞∆°ng.</p>

    <p class="message-line ending">Anh th∆∞∆°ng em. Th∆∞∆°ng thi·ªát.</p>
    <p class="message-line ending">NƒÉm m·ªõi gi·ªØ m√¨nh cho anh.</p>
    <p class="message-line ending" style="font-size: clamp(1.2rem,3.5vw,1.6rem); margin-top: 0.8em;">Th√°ng 3 anh t·ªõi. üíú</p>

    <button class="close-msg-btn" id="closeMsgBtn">ƒê√≥ng l·∫°i</button>
  </div>
</div>

<script>
(function() {
  'use strict';

  // ‚îÄ‚îÄ‚îÄ CANVAS SETUP ‚îÄ‚îÄ‚îÄ
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  let W, H, centerX, centerY, scale;
  const DPR = Math.min(window.devicePixelRatio || 1, 2);

  function resize() {
    W = window.innerWidth;
    H = window.innerHeight;
    canvas.width = W * DPR;
    canvas.height = H * DPR;
    canvas.style.width = W + 'px';
    canvas.style.height = H + 'px';
    ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
    centerX = W / 2;
    centerY = H / 2;
    scale = Math.min(W, H) / 600;
  }
  resize();
  window.addEventListener('resize', resize);

  // ‚îÄ‚îÄ‚îÄ CURSOR ‚îÄ‚îÄ‚îÄ
  const cursorGlow = document.getElementById('cursorGlow');
  let mouseX = -1000, mouseY = -1000;
  let isTouch = false;

  document.addEventListener('mousemove', e => {
    if (isTouch) return;
    mouseX = e.clientX;
    mouseY = e.clientY;
    cursorGlow.style.left = mouseX + 'px';
    cursorGlow.style.top = mouseY + 'px';
    cursorGlow.style.display = 'block';
  });

  document.addEventListener('touchmove', e => {
    isTouch = true;
    const t = e.touches[0];
    mouseX = t.clientX;
    mouseY = t.clientY;
    cursorGlow.style.display = 'none';
  }, { passive: true });

  document.addEventListener('touchend', () => {
    setTimeout(() => { mouseX = -1000; mouseY = -1000; }, 2000);
  });

  // ‚îÄ‚îÄ‚îÄ MUSIC ‚îÄ‚îÄ‚îÄ
  const bgMusic = document.getElementById('bgMusic');
  let musicStarted = false;
  function startMusic() {
    if (musicStarted) return;
    musicStarted = true;
    bgMusic.volume = 0.5;
    bgMusic.play().catch(() => {});
  }

  // ‚îÄ‚îÄ‚îÄ HEART SHAPE (parametric) ‚îÄ‚îÄ‚îÄ
  function heartX(t) {
    return 16 * Math.pow(Math.sin(t), 3);
  }
  function heartY(t) {
    return -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
  }

  // ‚îÄ‚îÄ‚îÄ INFINITY SHAPE ‚îÄ‚îÄ‚îÄ
  function infinityX(t) {
    return 26 * Math.cos(t) / (1 + Math.sin(t) * Math.sin(t));
  }
  function infinityY(t) {
    return 18 * Math.sin(t) * Math.cos(t) / (1 + Math.sin(t) * Math.sin(t));
  }

  // ‚îÄ‚îÄ‚îÄ COLORS ‚îÄ‚îÄ‚îÄ
  function getColor(i, total) {
    const ratio = i / total;
    const time = performance.now() * 0.001;
    const shift = Math.sin(time * 0.5 + ratio * Math.PI * 2);

    let r, g, b;
    if (ratio < 0.33) {
      // Neon Pink
      const t = ratio / 0.33;
      r = 255;
      g = 50 + t * 50;
      b = 150 + t * 80 + shift * 30;
    } else if (ratio < 0.66) {
      // Deep Purple
      const t = (ratio - 0.33) / 0.33;
      r = 180 - t * 40 + shift * 20;
      g = 50 + shift * 30;
      b = 220 + t * 35;
    } else {
      // Gold Dust
      const t = (ratio - 0.66) / 0.34;
      r = 255;
      g = 180 + t * 60 + shift * 20;
      b = 50 + t * 30;
    }

    return { r: Math.min(255, Math.max(0, r)), g: Math.min(255, Math.max(0, g)), b: Math.min(255, Math.max(0, b)) };
  }

  // ‚îÄ‚îÄ‚îÄ PARTICLES ‚îÄ‚îÄ‚îÄ
  const PARTICLE_COUNT = Math.min(8000, Math.max(3000, Math.floor(W * H / 200)));
  const particles = [];
  let animationStarted = false;
  let startTime = 0;
  let shapeMode = 0; // 0 = heart, cycles between heart and infinity blend

  class Particle {
    constructor(i) {
      this.i = i;
      this.reset();
    }

    reset() {
      // Random starting position
      this.x = Math.random() * W;
      this.y = Math.random() * H;
      this.vx = (Math.random() - 0.5) * 4;
      this.vy = (Math.random() - 0.5) * 4;

      // Target on heart shape
      const t = (this.i / PARTICLE_COUNT) * Math.PI * 2;
      const scatter = 0.85 + Math.random() * 0.3;
      this.heartTX = centerX + heartX(t) * 10 * scale * scatter;
      this.heartTY = centerY + heartY(t) * 10 * scale * scatter;

      // Target on infinity shape
      const t2 = (this.i / PARTICLE_COUNT) * Math.PI * 2;
      this.infTX = centerX + infinityX(t2) * 8 * scale * scatter;
      this.infTY = centerY + infinityY(t2) * 8 * scale * scatter;

      // Current target
      this.tx = this.heartTX;
      this.ty = this.heartTY;

      this.size = 0.5 + Math.random() * 1.8;
      this.baseSize = this.size;
      this.life = Math.random();
      this.speed = 0.01 + Math.random() * 0.03;

      const c = getColor(this.i, PARTICLE_COUNT);
      this.r = c.r;
      this.g = c.g;
      this.b = c.b;

      this.phase = Math.random() * Math.PI * 2;
      this.orbitRadius = Math.random() * 3;
      this.gathered = false;
    }

    update(time, elapsed, breathScale) {
      const gatherDuration = 4;
      const timeSinceStart = (time - startTime) / 1000;
      let gatherProgress = Math.min(1, timeSinceStart / gatherDuration);
      gatherProgress = easeInOutCubic(gatherProgress);

      // Blend between heart and infinity
      const morphCycle = Math.sin(time * 0.0003) * 0.5 + 0.5; // 0 to 1
      this.tx = this.heartTX * (1 - morphCycle * 0.3) + this.infTX * (morphCycle * 0.3);
      this.ty = this.heartTY * (1 - morphCycle * 0.3) + this.infTY * (morphCycle * 0.3);

      // Apply breath scale to target
      const btx = centerX + (this.tx - centerX) * breathScale;
      const bty = centerY + (this.ty - centerY) * breathScale;

      // Orbit
      const orbitX = Math.cos(time * 0.002 + this.phase) * this.orbitRadius * (1 - gatherProgress * 0.5);
      const orbitY = Math.sin(time * 0.002 + this.phase) * this.orbitRadius * (1 - gatherProgress * 0.5);

      const finalTX = btx + orbitX;
      const finalTY = bty + orbitY;

      if (gatherProgress < 1) {
        // Gathering phase
        const attractForce = gatherProgress * 0.08;
        this.vx += (finalTX - this.x) * attractForce;
        this.vy += (finalTY - this.y) * attractForce;
        this.vx *= 0.88;
        this.vy *= 0.88;
      } else {
        // Settled - spring physics
        const dx = finalTX - this.x;
        const dy = finalTY - this.y;
        this.vx += dx * 0.06;
        this.vy += dy * 0.06;
        this.vx *= 0.85;
        this.vy *= 0.85;
        this.gathered = true;
      }

      // Mouse/Touch interaction
      const mdx = this.x - mouseX;
      const mdy = this.y - mouseY;
      const mDist = Math.sqrt(mdx * mdx + mdy * mdy);
      const interactRadius = 120 * scale;

      if (mDist < interactRadius && mouseX > -500) {
        const force = (1 - mDist / interactRadius) * 8;
        this.vx += (mdx / mDist) * force;
        this.vy += (mdy / mDist) * force;
      }

      this.x += this.vx;
      this.y += this.vy;

      // Twinkle
      this.life += 0.02;
      const twinkle = 0.6 + 0.4 * Math.sin(this.life * 3 + this.phase);
      this.alpha = twinkle * (0.4 + gatherProgress * 0.6);
      this.size = this.baseSize * (0.8 + 0.4 * Math.sin(this.life * 2 + this.phase)) * (0.5 + gatherProgress * 0.5);

      // Update color over time
      const c = getColor(this.i + time * 0.01, PARTICLE_COUNT);
      this.r = this.r * 0.97 + c.r * 0.03;
      this.g = this.g * 0.97 + c.g * 0.03;
      this.b = this.b * 0.97 + c.b * 0.03;
    }
  }

  function easeInOutCubic(t) {
    return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
  }

  // Initialize particles
  for (let i = 0; i < PARTICLE_COUNT; i++) {
    particles.push(new Particle(i));
  }

  // ‚îÄ‚îÄ‚îÄ BACKGROUND STARS ‚îÄ‚îÄ‚îÄ
  const stars = [];
  const STAR_COUNT = 200;
  for (let i = 0; i < STAR_COUNT; i++) {
    stars.push({
      x: Math.random() * W,
      y: Math.random() * H,
      size: Math.random() * 1.5,
      twinkleSpeed: 0.5 + Math.random() * 2,
      phase: Math.random() * Math.PI * 2
    });
  }

  // ‚îÄ‚îÄ‚îÄ LIGHT RIPPLES ‚îÄ‚îÄ‚îÄ
  const ripples = [];

  function createRipple() {
    ripples.push({
      x: centerX,
      y: centerY,
      radius: 10,
      maxRadius: 200 * scale,
      alpha: 0.4,
      speed: 1 + Math.random() * 2,
      hue: Math.random() * 60 + 300 // pink-purple range
    });
  }

  // ‚îÄ‚îÄ‚îÄ SHOOTING STARS ‚îÄ‚îÄ‚îÄ
  const shootingStars = [];

  function createShootingStar() {
    const side = Math.random();
    let sx, sy, angle;
    if (side < 0.5) {
      sx = Math.random() * W;
      sy = -10;
      angle = Math.PI / 4 + Math.random() * Math.PI / 4;
    } else {
      sx = W + 10;
      sy = Math.random() * H * 0.5;
      angle = Math.PI * 0.6 + Math.random() * Math.PI / 4;
    }

    shootingStars.push({
      x: sx, y: sy,
      vx: Math.cos(angle) * (3 + Math.random() * 4),
      vy: Math.sin(angle) * (3 + Math.random() * 4),
      life: 1,
      length: 30 + Math.random() * 50,
      size: 1 + Math.random() * 1.5
    });
  }

  // ‚îÄ‚îÄ‚îÄ MAIN RENDER LOOP ‚îÄ‚îÄ‚îÄ
  let lastTime = 0;
  let rippleTimer = 0;
  let shootTimer = 0;

  function render(time) {
    requestAnimationFrame(render);
    if (!animationStarted) return;

    const elapsed = Math.min(time - lastTime, 50);
    lastTime = time;

    // Clear with deep space gradient
    const grad = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, Math.max(W, H) * 0.8);
    grad.addColorStop(0, 'rgba(15, 5, 25, 1)');
    grad.addColorStop(0.4, 'rgba(8, 2, 18, 1)');
    grad.addColorStop(1, 'rgba(2, 0, 8, 1)');
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, W, H);

    // Stars
    for (const star of stars) {
      const twinkle = 0.3 + 0.7 * Math.abs(Math.sin(time * 0.001 * star.twinkleSpeed + star.phase));
      ctx.beginPath();
      ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(200, 200, 255, ${twinkle * 0.7})`;
      ctx.fill();
    }

    // Shooting stars
    shootTimer += elapsed;
    if (shootTimer > 3000 + Math.random() * 5000) {
      shootTimer = 0;
      createShootingStar();
    }

    for (let i = shootingStars.length - 1; i >= 0; i--) {
      const s = shootingStars[i];
      s.x += s.vx;
      s.y += s.vy;
      s.life -= 0.008;

      if (s.life <= 0 || s.x < -50 || s.x > W + 50 || s.y > H + 50) {
        shootingStars.splice(i, 1);
        continue;
      }

      ctx.beginPath();
      const tailX = s.x - s.vx * s.length / 5;
      const tailY = s.y - s.vy * s.length / 5;
      const g = ctx.createLinearGradient(tailX, tailY, s.x, s.y);
      g.addColorStop(0, `rgba(255, 200, 255, 0)`);
      g.addColorStop(1, `rgba(255, 200, 255, ${s.life * 0.8})`);
      ctx.strokeStyle = g;
      ctx.lineWidth = s.size;
      ctx.moveTo(tailX, tailY);
      ctx.lineTo(s.x, s.y);
      ctx.stroke();
    }

    // Heartbeat breath
    const heartbeatPhase = time * 0.003;
    const beat1 = Math.pow(Math.sin(heartbeatPhase), 20) * 0.08;
    const beat2 = Math.pow(Math.sin(heartbeatPhase + 0.4), 20) * 0.05;
    const breathBase = 0.97 + Math.sin(time * 0.001) * 0.03;
    const breathScale = breathBase + beat1 + beat2;

    // Ripples
    rippleTimer += elapsed;
    if (rippleTimer > 800 + Math.random() * 400) {
      rippleTimer = 0;
      createRipple();
    }

    for (let i = ripples.length - 1; i >= 0; i--) {
      const r = ripples[i];
      r.radius += r.speed;
      r.alpha *= 0.985;

      if (r.alpha < 0.01 || r.radius > r.maxRadius) {
        ripples.splice(i, 1);
        continue;
      }

      ctx.beginPath();
      ctx.arc(r.x, r.y, r.radius * breathScale, 0, Math.PI * 2);
      ctx.strokeStyle = `hsla(${r.hue}, 80%, 70%, ${r.alpha})`;
      ctx.lineWidth = 1.5;
      ctx.stroke();
    }

    // Center glow (bloom behind particles)
    const timeSinceStart = (time - startTime) / 1000;
    const bloomAlpha = Math.min(0.15, timeSinceStart / 10 * 0.15);
    const bloomGrad = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, 180 * scale * breathScale);
    bloomGrad.addColorStop(0, `rgba(255, 100, 180, ${bloomAlpha * (1 + beat1 * 5)})`);
    bloomGrad.addColorStop(0.3, `rgba(180, 50, 200, ${bloomAlpha * 0.5})`);
    bloomGrad.addColorStop(0.6, `rgba(120, 40, 180, ${bloomAlpha * 0.2})`);
    bloomGrad.addColorStop(1, 'rgba(80, 20, 120, 0)');
    ctx.fillStyle = bloomGrad;
    ctx.fillRect(0, 0, W, H);

    // Update & render particles
    // Use ImageData for performance with many particles
    for (const p of particles) {
      p.update(time, elapsed, breathScale);
    }

    // Render particles with glow
    ctx.globalCompositeOperation = 'lighter';

    for (const p of particles) {
      if (p.x < -50 || p.x > W + 50 || p.y < -50 || p.y > H + 50) continue;

      const size = p.size * (1 + beat1 * 3);
      const alpha = p.alpha;

      if (alpha < 0.05) continue;

      // Glow
      const glowSize = size * 4;
      const grd = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, glowSize);
      grd.addColorStop(0, `rgba(${Math.floor(p.r)}, ${Math.floor(p.g)}, ${Math.floor(p.b)}, ${alpha * 0.8})`);
      grd.addColorStop(0.3, `rgba(${Math.floor(p.r)}, ${Math.floor(p.g)}, ${Math.floor(p.b)}, ${alpha * 0.3})`);
      grd.addColorStop(1, `rgba(${Math.floor(p.r)}, ${Math.floor(p.g)}, ${Math.floor(p.b)}, 0)`);

      ctx.beginPath();
      ctx.arc(p.x, p.y, glowSize, 0, Math.PI * 2);
      ctx.fillStyle = grd;
      ctx.fill();

      // Core
      ctx.beginPath();
      ctx.arc(p.x, p.y, size * 0.5, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(${Math.min(255, Math.floor(p.r + 60))}, ${Math.min(255, Math.floor(p.g + 60))}, ${Math.min(255, Math.floor(p.b + 60))}, ${alpha})`;
      ctx.fill();
    }

    ctx.globalCompositeOperation = 'source-over';

    // Vignette
    const vignette = ctx.createRadialGradient(centerX, centerY, Math.min(W, H) * 0.3, centerX, centerY, Math.max(W, H) * 0.8);
    vignette.addColorStop(0, 'rgba(0,0,0,0)');
    vignette.addColorStop(1, 'rgba(0,0,0,0.6)');
    ctx.fillStyle = vignette;
    ctx.fillRect(0, 0, W, H);
  }

  // ‚îÄ‚îÄ‚îÄ START LOGIC ‚îÄ‚îÄ‚îÄ
  const startOverlay = document.getElementById('startOverlay');
  const startBtn = document.getElementById('startBtn');
  const readBtn = document.getElementById('readBtn');
  const messageContainer = document.getElementById('messageContainer');
  const closeMsgBtn = document.getElementById('closeMsgBtn');
  const messageLines = document.querySelectorAll('.message-line');

  startBtn.addEventListener('click', () => {
    startOverlay.classList.add('hidden');
    animationStarted = true;
    startTime = performance.now();
    lastTime = startTime;
    startMusic();

    // Show read button after heart forms
    setTimeout(() => {
      readBtn.classList.add('visible');
    }, 5000);
  });

  startBtn.addEventListener('touchstart', (e) => {
    e.preventDefault();
    startBtn.click();
  }, { passive: false });

  // Auto-play music on any interaction (fallback)
  document.body.addEventListener('click', startMusic, { once: true });
  document.body.addEventListener('touchstart', startMusic, { once: true });

  // ‚îÄ‚îÄ‚îÄ MESSAGE LOGIC ‚îÄ‚îÄ‚îÄ
  readBtn.addEventListener('click', () => {
    messageContainer.classList.add('visible');
    readBtn.classList.remove('visible');

    // Animate lines in sequence
    messageLines.forEach((line, i) => {
      setTimeout(() => {
        line.classList.add('visible');
      }, 300 + i * 400);
    });

    // Show close button after all lines
    setTimeout(() => {
      closeMsgBtn.classList.add('visible');
    }, 300 + messageLines.length * 400 + 1000);
  });

  closeMsgBtn.addEventListener('click', () => {
    messageContainer.classList.remove('visible');
    setTimeout(() => {
      readBtn.classList.add('visible');
    }, 500);
  });

  // ‚îÄ‚îÄ‚îÄ KICK OFF ‚îÄ‚îÄ‚îÄ
  requestAnimationFrame(render);

  // ‚îÄ‚îÄ‚îÄ RESIZE STARS ‚îÄ‚îÄ‚îÄ
  window.addEventListener('resize', () => {
    for (const star of stars) {
      star.x = Math.random() * W;
      star.y = Math.random() * H;
    }
  });

})();
</script>
</body>
</html>
